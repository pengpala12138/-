from pro.utils.db_connection import create_db_connection, execute_batch_query, execute_query

# -------------------------- 数据库配置 --------------------------
HOST = "192.168.69.97"
USER = "qq"
PASSWORD = "515408"
DATABASE = "sjk"
# ----------------------------------------------------------------

# ===================== 1. 科研项目表固定数据（20条） =====================
project_data = [
    ("PROJ-2025-001", "大熊猫栖息地生态修复研究", "LEADER-001", "国家公园科研院", "2025-01-10", "2025-12-31", "在研", "物种保护"),
    ("PROJ-2025-002", "金丝猴种群数量监测", "LEADER-002", "西南林业大学", "2025-01-15", None, "在研", "生物多样性"),
    ("PROJ-2025-003", "湿地生态系统水质监测", "LEADER-003", "环境科学研究院", "2024-06-01", "2025-03-20", "已结题", "环境监测"),
    ("PROJ-2025-004", "高山草甸植被恢复实验", "LEADER-004", "国家公园管理局", "2025-02-01", None, "在研", "植被恢复"),
    ("PROJ-2025-005", "雪豹生存环境评估", "LEADER-005", "西北濒危动物保护中心", "2024-08-10", "2025-01-15", "已结题", "物种保护"),
    ("PROJ-2025-006", "森林火灾风险预警模型", "LEADER-006", "林业科学研究院", "2025-03-05", None, "暂停", "生态修复"),
    ("PROJ-2025-007", "候鸟迁徙路线追踪", "LEADER-007", "鸟类保护协会", "2024-11-20", None, "在研", "生物多样性"),
    ("PROJ-2025-008", "土壤有机质含量分析", "LEADER-008", "农业科学院", "2025-01-20", "2025-04-30", "已结题", "生态环境"),
    ("PROJ-2025-009", "冰川消融速率监测", "LEADER-009", "中科院寒区研究所", "2024-09-01", None, "在研", "气候变化"),
    ("PROJ-2025-010", "红豆杉人工繁育技术", "LEADER-010", "药用植物研究所", "2025-02-15", None, "在研", "物种保护"),
    ("PROJ-2025-011", "河流生态廊道构建", "LEADER-011", "水利科学研究院", "2024-10-05", "2025-02-28", "已结题", "生态修复"),
    ("PROJ-2025-012", "草原鼠害防治研究", "LEADER-012", "草原保护站", "2025-03-10", None, "在研", "生态环境"),
    ("PROJ-2025-013", "大气颗粒物监测分析", "LEADER-013", "环境监测中心", "2024-07-15", None, "暂停", "环境监测"),
    ("PROJ-2025-014", "两栖动物栖息地保护", "LEADER-014", "野生动物保护协会", "2025-01-25", None, "在研", "生物多样性"),
    ("PROJ-2025-015", "碳汇林培育技术研究", "LEADER-015", "林业碳汇研究院", "2024-12-01", None, "在研", "气候变化"),
    ("PROJ-2025-016", "湖泊富营养化治理", "LEADER-016", "水环境研究所", "2024-08-20", "2025-01-10", "已结题", "生态环境"),
    ("PROJ-2025-017", "藏羚羊迁徙保护", "LEADER-017", "青藏高原研究所", "2025-02-20", None, "在研", "物种保护"),
    ("PROJ-2025-018", "林下经济模式探索", "LEADER-018", "乡村振兴研究院", "2024-11-05", None, "在研", "生态修复"),
    ("PROJ-2025-019", "酸雨对植被影响研究", "LEADER-019", "环境生态研究所", "2025-03-15", None, "暂停", "环境监测"),
    ("PROJ-2025-020", "昆虫多样性调查", "LEADER-020", "昆虫学研究所", "2024-09-20", "2025-03-15", "已结题", "生物多样性")
]

# ===================== 2. 科研数据采集记录表（20条，删除region_id） =====================
collection_data = [
    ("COLL-2025-001", "PROJ-2025-001", "COLL-001", "2025-01-15 09:00:00", "大熊猫栖息地植被覆盖度采集，样方1-10", "实地采集"),
    ("COLL-2025-002", "PROJ-2025-002", "COLL-002", "2025-01-20 10:30:00", "金丝猴种群数量统计，红外相机数据", "实地采集"),
    ("COLL-2025-003", "PROJ-2025-003", "COLL-003", "2025-02-05 14:00:00", "湿地水质pH值、溶解氧含量检测", "实地采集"),
    ("COLL-2025-004", "PROJ-2025-004", "COLL-004", "2025-02-10 08:45:00", "草甸植被高度、盖度测量，样线法", "实地采集"),
    ("COLL-2025-005", "PROJ-2025-005", "COLL-005", "2025-01-05 11:20:00", "雪豹活动痕迹记录，粪便、足迹采样", "实地采集"),
    ("COLL-2025-006", "PROJ-2025-006", "COLL-006", "2025-03-08 15:30:00", "森林可燃物载量调查，样方采集", "系统调用"),
    ("COLL-2025-007", "PROJ-2025-007", "COLL-007", "2025-01-28 07:50:00", "候鸟环志数据录入，GPS定位追踪", "系统调用"),
    ("COLL-2025-008", "PROJ-2025-008", "COLL-008", "2025-03-01 13:15:00", "土壤样本有机质含量实验室分析", "系统调用"),
    ("COLL-2025-009", "PROJ-2025-009", "COLL-009", "2025-02-18 09:30:00", "冰川厚度测量，雷达扫描数据", "实地采集"),
    ("COLL-2025-010", "PROJ-2025-010", "COLL-010", "2025-02-25 10:10:00", "红豆杉种子发芽率试验数据记录", "系统调用"),
    ("COLL-2025-011", "PROJ-2025-011", "COLL-011", "2025-01-12 16:40:00", "河流流速、流量监测，水文站数据", "系统调用"),
    ("COLL-2025-012", "PROJ-2025-012", "COLL-012", "2025-03-12 08:20:00", "草原鼠洞数量统计，样方调查", "实地采集"),
    ("COLL-2025-013", "PROJ-2025-013", "COLL-013", "2025-02-08 14:50:00", "PM2.5浓度小时数据，监测站导出", "系统调用"),
    ("COLL-2025-014", "PROJ-2025-014", "COLL-014", "2025-01-30 10:00:00", "蛙类种群数量调查，夜间监测", "实地采集"),
    ("COLL-2025-015", "PROJ-2025-015", "COLL-015", "2025-02-22 11:45:00", "碳汇林生长量测量，胸径、树高记录", "实地采集"),
    ("COLL-2025-016", "PROJ-2025-016", "COLL-016", "2025-01-08 15:10:00", "湖泊氮磷含量检测，水样分析", "系统调用"),
    ("COLL-2025-017", "PROJ-2025-017", "COLL-017", "2025-03-05 09:15:00", "藏羚羊迁徙路线GPS追踪数据", "实地采集"),
    ("COLL-2025-018", "PROJ-2025-018", "COLL-018", "2025-02-15 13:30:00", "林下作物产量统计，样方收获记录", "系统调用"),
    ("COLL-2025-019", "PROJ-2025-019", "COLL-019", "2025-03-18 10:50:00", "酸雨pH值监测，降雨采样分析", "实地采集"),
    ("COLL-2025-020", "PROJ-2025-020", "COLL-020", "2025-02-01 14:20:00", "昆虫种类鉴定，标本采集记录", "系统调用")
]

# ===================== 3. 科研成果信息表（20条） =====================
achievement_data = [
    ("ACH-2025-001", "PROJ-2025-001", "论文", "大熊猫栖息地生态修复技术研究", "2025-04-10", "内部共享", "/data/ach/ACH-2025-001.pdf"),
    ("ACH-2025-002", "PROJ-2025-002", "报告", "2025年金丝猴种群监测年报", "2025-03-20", "公开", "/data/ach/ACH-2025-002.docx"),
    ("ACH-2025-003", "PROJ-2025-003", "报告", "湿地水质监测分析报告（2024-2025）", "2025-04-05", "内部共享", "/data/ach/ACH-2025-003.pdf"),
    ("ACH-2025-004", "PROJ-2025-004", "论文", "高山草甸植被恢复的关键技术", "2025-05-15", "公开", "/data/ach/ACH-2025-004.pdf"),
    ("ACH-2025-005", "PROJ-2025-005", "报告", "雪豹生存环境评估报告", "2025-02-10", "保密", "/data/ach/ACH-2025-005.docx"),
    ("ACH-2025-006", "PROJ-2025-006", "专利", "森林火灾风险预警系统V1.0", "2025-03-25", "内部共享", "/data/ach/ACH-2025-006.txt"),
    ("ACH-2025-007", "PROJ-2025-007", "论文", "候鸟迁徙路线的GPS追踪分析", "2025-04-20", "公开", "/data/ach/ACH-2025-007.pdf"),
    ("ACH-2025-008", "PROJ-2025-008", "报告", "土壤有机质含量分析报告", "2025-05-01", "内部共享", "/data/ach/ACH-2025-008.docx"),
    ("ACH-2025-009", "PROJ-2025-009", "论文", "冰川消融速率与气候变化的关系", "2025-06-10", "公开", "/data/ach/ACH-2025-009.pdf"),
    ("ACH-2025-010", "PROJ-2025-010", "专利", "红豆杉人工繁育培养基配方", "2025-04-15", "保密", "/data/ach/ACH-2025-010.txt"),
    ("ACH-2025-011", "PROJ-2025-011", "报告", "河流生态廊道构建效果评估", "2025-03-05", "内部共享", "/data/ach/ACH-2025-011.pdf"),
    ("ACH-2025-012", "PROJ-2025-012", "论文", "草原鼠害绿色防治技术研究", "2025-05-20", "公开", "/data/ach/ACH-2025-012.pdf"),
    ("ACH-2025-013", "PROJ-2025-013", "报告", "大气颗粒物监测数据分析报告", "2025-04-25", "保密", "/data/ach/ACH-2025-013.docx"),
    ("ACH-2025-014", "PROJ-2025-014", "论文", "两栖动物栖息地保护的关键措施", "2025-06-05", "内部共享", "/data/ach/ACH-2025-014.pdf"),
    ("ACH-2025-015", "PROJ-2025-015", "专利", "碳汇林培育密度控制方法", "2025-05-08", "公开", "/data/ach/ACH-2025-015.txt"),
    ("ACH-2025-016", "PROJ-2025-016", "报告", "湖泊富营养化治理效果总结", "2025-02-18", "内部共享", "/data/ach/ACH-2025-016.docx"),
    ("ACH-2025-017", "PROJ-2025-017", "论文", "藏羚羊迁徙保护的生态策略", "2025-04-30", "公开", "/data/ach/ACH-2025-017.pdf"),
    ("ACH-2025-018", "PROJ-2025-018", "报告", "林下经济模式经济效益分析", "2025-05-12", "内部共享", "/data/ach/ACH-2025-018.pdf"),
    ("ACH-2025-019", "PROJ-2025-019", "论文", "酸雨对高山植被的影响机制", "2025-06-18", "保密", "/data/ach/ACH-2025-019.pdf"),
    ("ACH-2025-020", "PROJ-2025-020", "报告", "昆虫多样性调查完整报告", "2025-03-18", "公开", "/data/ach/ACH-2025-020.docx")
]

# ===================== 4. 项目-成果共享关联表（20条） =====================
share_rel_data = [
    ("PROJ-2025-001", "ACH-2025-001", "2025-04-12 08:00:00", "AUTH-001"),
    ("PROJ-2025-002", "ACH-2025-002", "2025-03-22 09:30:00", "AUTH-002"),
    ("PROJ-2025-003", "ACH-2025-003", "2025-04-07 10:15:00", "AUTH-003"),
    ("PROJ-2025-004", "ACH-2025-004", "2025-05-17 14:20:00", "AUTH-004"),
    ("PROJ-2025-005", "ACH-2025-005", "2025-02-12 11:00:00", "AUTH-005"),
    ("PROJ-2025-006", "ACH-2025-006", "2025-03-27 15:40:00", "AUTH-006"),
    ("PROJ-2025-007", "ACH-2025-007", "2025-04-22 08:45:00", "AUTH-007"),
    ("PROJ-2025-008", "ACH-2025-008", "2025-05-03 13:30:00", "AUTH-008"),
    ("PROJ-2025-009", "ACH-2025-009", "2025-06-12 09:10:00", "AUTH-009"),
    ("PROJ-2025-010", "ACH-2025-010", "2025-04-17 16:25:00", "AUTH-010"),
    ("PROJ-2025-011", "ACH-2025-011", "2025-03-07 10:50:00", "AUTH-011"),
    ("PROJ-2025-012", "ACH-2025-012", "2025-05-22 14:15:00", "AUTH-012"),
    ("PROJ-2025-013", "ACH-2025-013", "2025-04-27 11:30:00", "AUTH-013"),
    ("PROJ-2025-014", "ACH-2025-014", "2025-06-07 08:55:00", "AUTH-014"),
    ("PROJ-2025-015", "ACH-2025-015", "2025-05-10 15:00:00", "AUTH-015"),
    ("PROJ-2025-016", "ACH-2025-016", "2025-02-20 09:20:00", "AUTH-016"),
    ("PROJ-2025-017", "ACH-2025-017", "2025-05-02 12:40:00", "AUTH-017"),
    ("PROJ-2025-018", "ACH-2025-018", "2025-05-14 14:50:00", "AUTH-018"),
    ("PROJ-2025-019", "ACH-2025-019", "2025-06-20 10:10:00", "AUTH-019"),
    ("PROJ-2025-020", "ACH-2025-020", "2025-03-20 13:15:00", "AUTH-020")
]

# ===================== 5. 采集-监测数据关联表（20条） =====================
data_rel_data = [
    ("COLL-2025-001", "MON-2025-001", "生物多样性监测数据"),
    ("COLL-2025-002", "MON-2025-002", "生物多样性监测数据"),
    ("COLL-2025-003", "MON-2025-003", "生态环境监测数据"),
    ("COLL-2025-004", "MON-2025-004", "生态环境监测数据"),
    ("COLL-2025-005", "MON-2025-005", "生物多样性监测数据"),
    ("COLL-2025-006", "MON-2025-006", "生态环境监测数据"),
    ("COLL-2025-007", "MON-2025-007", "生物多样性监测数据"),
    ("COLL-2025-008", "MON-2025-008", "生态环境监测数据"),
    ("COLL-2025-009", "MON-2025-009", "生态环境监测数据"),
    ("COLL-2025-010", "MON-2025-010", "生物多样性监测数据"),
    ("COLL-2025-011", "MON-2025-011", "生态环境监测数据"),
    ("COLL-2025-012", "MON-2025-012", "生态环境监测数据"),
    ("COLL-2025-013", "MON-2025-013", "生态环境监测数据"),
    ("COLL-2025-014", "MON-2025-014", "生物多样性监测数据"),
    ("COLL-2025-015", "MON-2025-015", "生态环境监测数据"),
    ("COLL-2025-016", "MON-2025-016", "生态环境监测数据"),
    ("COLL-2025-017", "MON-2025-017", "生物多样性监测数据"),
    ("COLL-2025-018", "MON-2025-018", "生态环境监测数据"),
    ("COLL-2025-019", "MON-2025-019", "生态环境监测数据"),
    ("COLL-2025-020", "MON-2025-020", "生物多样性监测数据")
]

# ===================== 执行数据插入（先清空旧数据） =====================
if __name__ == "__main__":
    # 1. 连接数据库
    db_conn = create_db_connection(HOST, USER, PASSWORD, DATABASE)
    if not db_conn:
        exit(1)

    # 2. 清空旧数据（按依赖倒序）
    print("🗑️  正在清空旧数据...")
    clear_sql_list = [
        "DELETE FROM collection_monitor_data_rel;",
        "DELETE FROM project_achievement_share;",
        "DELETE FROM research_achievement;",
        "DELETE FROM research_data_collection;",
        "DELETE FROM research_project;"
    ]
    for sql in clear_sql_list:
        execute_query(db_conn, sql)

    # 3. 插入科研项目表
    project_sql = """
    INSERT INTO research_project (project_id, project_name, leader_id, apply_unit, approval_time, conclusion_time, project_status, research_field)
    VALUES (%s, %s, %s, %s, %s, %s, %s, %s)
    """
    execute_batch_query(db_conn, project_sql, project_data)
    print("✅ 科研项目表插入20条数据成功")

    # 4. 插入数据采集记录表（无region_id）
    collection_sql = """
    INSERT INTO research_data_collection (collection_id, project_id, collector_id, collection_time, collection_content, data_source)
    VALUES (%s, %s, %s, %s, %s, %s)
    """
    execute_batch_query(db_conn, collection_sql, collection_data)
    print("✅ 科研数据采集表插入20条数据成功")

    # 5. 插入科研成果表
    achievement_sql = """
    INSERT INTO research_achievement (achievement_id, project_id, achievement_type, achievement_name, publish_time, share_permission, file_path)
    VALUES (%s, %s, %s, %s, %s, %s, %s)
    """
    execute_batch_query(db_conn, achievement_sql, achievement_data)
    print("✅ 科研成果表插入20条数据成功")

    # 6. 插入项目-成果共享关联表
    share_rel_sql = """
    INSERT INTO project_achievement_share (project_id, achievement_id, share_time, authorizer_id)
    VALUES (%s, %s, %s, %s)
    """
    execute_batch_query(db_conn, share_rel_sql, share_rel_data)
    print("✅ 项目-成果共享表插入20条数据成功")

    # 7. 插入采集-监测数据关联表
    data_rel_sql = """
    INSERT INTO collection_monitor_data_rel (collection_id, monitor_data_id, data_type)
    VALUES (%s, %s, %s)
    """
    execute_batch_query(db_conn, data_rel_sql, data_rel_data)
    print("✅ 采集-监测关联表插入20条数据成功")

    # 8. 关闭连接
    db_conn.close()
    print("\n🎉 所有表旧数据已清空，20条固定数据全部插入成功！无任何region关联字段")