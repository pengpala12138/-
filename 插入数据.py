import pymysql
from pymysql import Error
from datetime import datetime

# -------------------------- é…ç½®é¡¹ï¼ˆè¯·æ›¿æ¢ä¸ºä½ çš„MySQLä¿¡æ¯ï¼‰--------------------------
MYSQL_CONFIG = {
    "host": "172.20.10.4",       # æœ¬åœ°æ•°æ®åº“å¡«localhostï¼Œè¿œç¨‹å¡«æœåŠ¡å™¨IP
    "user": "fxt",            # ä½ çš„MySQLç”¨æˆ·åï¼ˆå¦‚rootï¼‰
    "password": "515408",# ä½ çš„MySQLç™»å½•å¯†ç 
    "database": "sjk",         # ç›®æ ‡æ•°æ®åº“åï¼ˆå·²åˆ›å»ºçš„sjkï¼‰
    "charset": "utf8mb4",      # å­—ç¬¦é›†ï¼ˆé¿å…ä¸­æ–‡ä¹±ç ï¼‰
    "cursorclass": pymysql.cursors.DictCursor  # å¯é€‰ï¼šè¿”å›å­—å…¸æ ¼å¼ç»“æœï¼ˆä¸å½±å“æ’å…¥åŠŸèƒ½ï¼‰
}

# -------------------------- æ¨¡æ‹Ÿæ•°æ®ï¼ˆä¸åŸä»£ç å®Œå…¨ä¸€è‡´ï¼Œæ— ä¿®æ”¹ï¼‰--------------------------
# 1. æ¸¸å®¢è¡¨æ•°æ®ï¼ˆæ— å¤–é”®ä¾èµ–ï¼Œå…ˆæ’å…¥ï¼‰
TOURISTS_DATA = [
    ('TOUR001', 'å¼ ä¸‰', '530102199001011234', '13800138001', '2025-12-01 09:00:00', '2025-12-01 17:00:00', 'online'),
    ('TOUR002', 'æå››', '530102199102022345', '13900139002', '2025-12-01 09:30:00', '2025-12-01 18:00:00', 'onsite'),
    ('TOUR003', 'ç‹äº”', '510102199203033456', '13700137003', '2025-12-02 10:00:00', '2025-12-02 16:30:00', 'online'),
    ('TOUR004', 'èµµå…­', '510102199304044567', '13600136004', '2025-12-02 10:30:00', '2025-12-02 17:30:00', 'onsite'),
    ('TOUR005', 'å­™ä¸ƒ', '610102199405055678', '13500135005', '2025-12-03 08:30:00', '2025-12-03 15:30:00', 'online'),
    ('TOUR006', 'å‘¨å…«', '610102199506066789', '13400134006', '2025-12-03 09:00:00', '2025-12-03 16:00:00', 'onsite'),
    ('TOUR007', 'å´ä¹', '630102199607077890', '13300133007', '2025-12-04 09:30:00', '2025-12-04 17:00:00', 'online'),
    ('TOUR008', 'éƒ‘å', '630102199708088901', '13200132008', '2025-12-04 10:00:00', '2025-12-04 18:00:00', 'onsite'),
    ('TOUR009', 'å†¯åä¸€', '420102199809099012', '13100131009', '2025-12-05 08:00:00', '2025-12-05 15:00:00', 'online'),
    ('TOUR010', 'é™ˆåäºŒ', '420102199910100123', '13000130010', '2025-12-05 08:30:00', '2025-12-05 16:30:00', 'onsite'),
    ('TOUR011', 'è¤šåä¸‰', '360102200011111234', '15900159011', '2025-12-06 09:00:00', '2025-12-06 17:00:00', 'online'),
    ('TOUR012', 'å«åå››', '360102200112122345', '15800158012', '2025-12-06 09:30:00', '2025-12-06 18:00:00', 'onsite'),
    ('TOUR013', 'è’‹åäº”', '330102200201133456', '15700157013', '2025-12-07 10:00:00', '2025-12-07 16:30:00', 'online'),
    ('TOUR014', 'æ²ˆåå…­', '330102200302144567', '15600156014', '2025-12-07 10:30:00', '2025-12-07 17:30:00', 'onsite'),
    ('TOUR015', 'éŸ©åä¸ƒ', '310102200403155678', '15500155015', '2025-12-08 08:30:00', '2025-12-08 15:30:00', 'online'),
    ('TOUR016', 'æ¨åå…«', '310102200504166789', '15400154016', '2025-12-08 09:00:00', '2025-12-08 16:00:00', 'onsite'),
    ('TOUR017', 'æœ±åä¹', '440102200605177890', '15300153017', '2025-12-09 09:30:00', '2025-12-09 17:00:00', 'online'),
    ('TOUR018', 'ç§¦äºŒå', '440102200706188901', '15200152018', '2025-12-09 10:00:00', '2025-12-09 18:00:00', 'onsite'),
    ('TOUR019', 'å°¤äºŒåä¸€', '450102200807199012', '15100151019', '2025-12-10 08:00:00', '2025-12-10 15:00:00', 'online'),
    ('TOUR020', 'è®¸äºŒåäºŒ', '450102200908200123', '15000150020', '2025-12-10 08:30:00', '2025-12-10 16:30:00', 'onsite')
]

# 2. é¢„çº¦è¡¨æ•°æ®ï¼ˆä¾èµ–tourists.tourist_idï¼‰
RESERVATIONS_DATA = [
    ('RES001', 'TOUR001', '2025-12-01', '09:00-10:00', 2, 'completed', 100.00, 'paid'),
    ('RES002', 'TOUR002', '2025-12-01', '09:30-10:30', 1, 'completed', 50.00, 'paid'),
    ('RES003', 'TOUR003', '2025-12-02', '10:00-11:00', 3, 'completed', 150.00, 'paid'),
    ('RES004', 'TOUR004', '2025-12-02', '10:30-11:30', 2, 'completed', 100.00, 'paid'),
    ('RES005', 'TOUR005', '2025-12-03', '08:30-09:30', 1, 'completed', 50.00, 'paid'),
    ('RES006', 'TOUR006', '2025-12-03', '09:00-10:00', 4, 'completed', 200.00, 'paid'),
    ('RES007', 'TOUR007', '2025-12-04', '09:30-10:30', 2, 'completed', 100.00, 'paid'),
    ('RES008', 'TOUR008', '2025-12-04', '10:00-11:00', 1, 'completed', 50.00, 'paid'),
    ('RES009', 'TOUR009', '2025-12-05', '08:00-09:00', 3, 'completed', 150.00, 'paid'),
    ('RES010', 'TOUR010', '2025-12-05', '08:30-09:30', 2, 'completed', 100.00, 'paid'),
    ('RES011', 'TOUR011', '2025-12-06', '09:00-10:00', 1, 'completed', 50.00, 'paid'),
    ('RES012', 'TOUR012', '2025-12-06', '09:30-10:30', 4, 'completed', 200.00, 'paid'),
    ('RES013', 'TOUR013', '2025-12-07', '10:00-11:00', 2, 'completed', 100.00, 'paid'),
    ('RES014', 'TOUR014', '2025-12-07', '10:30-11:30', 1, 'completed', 50.00, 'paid'),
    ('RES015', 'TOUR015', '2025-12-08', '08:30-09:30', 3, 'completed', 150.00, 'paid'),
    ('RES016', 'TOUR016', '2025-12-08', '09:00-10:00', 2, 'completed', 100.00, 'paid'),
    ('RES017', 'TOUR017', '2025-12-09', '09:30-10:30', 1, 'completed', 50.00, 'paid'),
    ('RES018', 'TOUR018', '2025-12-09', '10:00-11:00', 4, 'completed', 200.00, 'paid'),
    ('RES019', 'TOUR019', '2025-12-10', '08:00-09:00', 2, 'completed', 100.00, 'paid'),
    ('RES020', 'TOUR020', '2025-12-10', '08:30-09:30', 1, 'completed', 50.00, 'paid')
]

# 3. è½¨è¿¹è¡¨æ•°æ®ï¼ˆä¾èµ–tourists.tourist_idï¼Œarea_idç”¨region_infoçš„region_idï¼‰
TRAJECTORIES_DATA = [
    ('TOUR001', '2025-12-01 09:30:00', 22.000000, 100.800000, 'R001', False, False),
    ('TOUR002', '2025-12-01 10:00:00', 22.700000, 100.900000, 'R002', False, False),
    ('TOUR003', '2025-12-02 10:30:00', 23.500000, 100.100000, 'R003', False, False),
    ('TOUR004', '2025-12-02 11:00:00', 31.300000, 103.600000, 'R004', True, True),
    ('TOUR005', '2025-12-03 09:00:00', 34.000000, 108.000000, 'R005', False, False),
    ('TOUR006', '2025-12-03 09:30:00', 35.000000, 90.000000, 'R006', False, False),
    ('TOUR007', '2025-12-04 10:00:00', 35.500000, 90.500000, 'R007', True, False),
    ('TOUR008', '2025-12-04 10:30:00', 29.000000, 94.000000, 'R007', False, False),
    ('TOUR009', '2025-12-05 08:30:00', 25.200000, 110.300000, 'R008', False, False),
    ('TOUR010', '2025-12-05 09:00:00', 27.800000, 108.700000, 'R009', False, False),
    ('TOUR011', '2025-12-06 09:30:00', 31.700000, 110.400000, 'R010', True, True),
    ('TOUR012', '2025-12-06 10:00:00', 28.500000, 116.000000, 'R011', False, False),
    ('TOUR013', '2025-12-07 10:30:00', 29.000000, 112.500000, 'R012', False, False),
    ('TOUR014', '2025-12-07 11:00:00', 49.000000, 119.000000, 'R013', False, False),
    ('TOUR015', '2025-12-08 09:00:00', 42.000000, 87.000000, 'R014', True, False),
    ('TOUR016', '2025-12-08 09:30:00', 47.000000, 124.000000, 'R015', False, False),
    ('TOUR017', '2025-12-09 10:00:00', 33.300000, 120.000000, 'R016', False, False),
    ('TOUR018', '2025-12-09 10:30:00', 29.500000, 119.000000, 'R017', False, False),
    ('TOUR019', '2025-12-10 08:30:00', 30.100000, 118.200000, 'R018', True, True),
    ('TOUR020', '2025-12-10 09:00:00', 27.700000, 117.900000, 'R019', False, False)
]

# 4. æµé‡æ§åˆ¶è¡¨æ•°æ®ï¼ˆarea_idç”¨region_infoçš„region_idï¼Œæ— å¤–é”®ä¾èµ–ï¼‰
FLOW_CONTROL_DATA = [
    ('R001', 5000, 3800, 0.80, 'normal'),
    ('R002', 3000, 2500, 0.80, 'warning'),
    ('R003', 2500, 1800, 0.80, 'normal'),
    ('R004', 4000, 3500, 0.80, 'warning'),
    ('R005', 4500, 3200, 0.80, 'normal'),
    ('R006', 2000, 1500, 0.80, 'normal'),
    ('R007', 1500, 1300, 0.80, 'warning'),
    ('R008', 3500, 2800, 0.80, 'warning'),
    ('R009', 3000, 2200, 0.80, 'normal'),
    ('R010', 4000, 3000, 0.80, 'normal'),
    ('R011', 2500, 2100, 0.80, 'warning'),
    ('R012', 3000, 2400, 0.80, 'warning'),
    ('R013', 2000, 1400, 0.80, 'normal'),
    ('R014', 1800, 1300, 0.80, 'normal'),
    ('R015', 3500, 2900, 0.80, 'warning'),
    ('R016', 2500, 1900, 0.80, 'normal'),
    ('R017', 3000, 2300, 0.80, 'normal'),
    ('R018', 4000, 3300, 0.80, 'warning'),
    ('R019', 3500, 2700, 0.80, 'normal'),
    ('R020', 2000, 1600, 0.80, 'warning')
]

# 5. ç³»ç»Ÿæ—¥å¿—è¡¨æ•°æ®ï¼ˆæ— å¤–é”®ä¾èµ–ï¼‰
SYSTEM_LOGS_DATA = [
    ('info', 'tourist', 'æ¸¸å®¢TOUR001æˆåŠŸå…¥å›­', 'TOUR001', '192.168.1.101'),
    ('info', 'reservation', 'é¢„çº¦RES002åˆ›å»ºæˆåŠŸ', 'TOUR002', '192.168.1.102'),
    ('warning', 'trajectory', 'æ¸¸å®¢TOUR004åç¦»è·¯çº¿', 'TOUR004', '192.168.1.104'),
    ('info', 'tourist', 'æ¸¸å®¢TOUR005å®Œæˆå‡ºå›­', 'TOUR005', '192.168.1.105'),
    ('error', 'payment', 'é¢„çº¦RES006æ”¯ä»˜è¶…æ—¶', 'TOUR006', '192.168.1.106'),
    ('info', 'trajectory', 'æ¸¸å®¢TOUR007ä½ç½®æ›´æ–°', 'TOUR007', '192.168.1.107'),
    ('warning', 'flow_control', 'åŒºåŸŸR007æ¸¸å®¢æ¥è¿‘é˜ˆå€¼', 'ADMIN', '192.168.1.200'),
    ('info', 'tourist', 'æ¸¸å®¢TOUR008æˆåŠŸå…¥å›­', 'TOUR008', '192.168.1.108'),
    ('info', 'reservation', 'é¢„çº¦RES009çŠ¶æ€æ›´æ–°ä¸ºcompleted', 'TOUR009', '192.168.1.109'),
    ('warning', 'trajectory', 'æ¸¸å®¢TOUR011åç¦»è·¯çº¿', 'TOUR011', '192.168.1.111'),
    ('info', 'tourist', 'æ¸¸å®¢TOUR012å®Œæˆå‡ºå›­', 'TOUR012', '192.168.1.112'),
    ('info', 'flow_control', 'åŒºåŸŸR012çŠ¶æ€æ›´æ–°ä¸ºwarning', 'ADMIN', '192.168.1.200'),
    ('error', 'system', 'å¤‡ä»½ä»»åŠ¡ä¸´æ—¶ä¸­æ–­', 'SYSTEM', '192.168.1.255'),
    ('info', 'reservation', 'é¢„çº¦RES014æ”¯ä»˜æˆåŠŸ', 'TOUR014', '192.168.1.114'),
    ('warning', 'trajectory', 'æ¸¸å®¢TOUR015åç¦»è·¯çº¿', 'TOUR015', '192.168.1.115'),
    ('info', 'tourist', 'æ¸¸å®¢TOUR016æˆåŠŸå…¥å›­', 'TOUR016', '192.168.1.116'),
    ('info', 'flow_control', 'åŒºåŸŸR018çŠ¶æ€æ›´æ–°ä¸ºwarning', 'ADMIN', '192.168.1.200'),
    ('warning', 'trajectory', 'æ¸¸å®¢TOUR019åç¦»è·¯çº¿', 'TOUR019', '192.168.1.119'),
    ('info', 'reservation', 'é¢„çº¦RES020çŠ¶æ€æ›´æ–°ä¸ºcompleted', 'TOUR020', '192.168.1.120'),
    ('info', 'system', 'ç³»ç»Ÿæ—¥å¿—æ¸…ç†å®Œæˆ', 'SYSTEM', '192.168.1.255')
]

# 6. å¤‡ä»½è®°å½•è¡¨æ•°æ®ï¼ˆæ— å¤–é”®ä¾èµ–ï¼‰
BACKUP_LOGS_DATA = [
    ('full', '/backup/20251201_full', 104857600, 'success', '2025-12-01 02:00:00', '2025-12-01 02:30:00', 'å…¨é‡å¤‡ä»½æˆåŠŸ'),
    ('incremental', '/backup/20251201_incr', 20971520, 'success', '2025-12-01 12:00:00', '2025-12-01 12:10:00', 'å¢é‡å¤‡ä»½æˆåŠŸ'),
    ('full', '/backup/20251202_full', 108922880, 'success', '2025-12-02 02:00:00', '2025-12-02 02:35:00', 'å…¨é‡å¤‡ä»½æˆåŠŸ'),
    ('incremental', '/backup/20251202_incr', 25165824, 'success', '2025-12-02 12:00:00', '2025-12-02 12:12:00', 'å¢é‡å¤‡ä»½æˆåŠŸ'),
    ('full', '/backup/20251203_full', 113088160, 'success', '2025-12-03 02:00:00', '2025-12-03 02:40:00', 'å…¨é‡å¤‡ä»½æˆåŠŸ'),
    ('incremental', '/backup/20251203_incr', 18874368, 'success', '2025-12-03 12:00:00', '2025-12-03 12:08:00', 'å¢é‡å¤‡ä»½æˆåŠŸ'),
    ('full', '/backup/20251204_full', 117253440, 'success', '2025-12-04 02:00:00', '2025-12-04 02:45:00', 'å…¨é‡å¤‡ä»½æˆåŠŸ'),
    ('incremental', '/backup/20251204_incr', 23068672, 'success', '2025-12-04 12:00:00', '2025-12-04 12:11:00', 'å¢é‡å¤‡ä»½æˆåŠŸ'),
    ('full', '/backup/20251205_full', 121418720, 'success', '2025-12-05 02:00:00', '2025-12-05 02:50:00', 'å…¨é‡å¤‡ä»½æˆåŠŸ'),
    ('incremental', '/backup/20251205_incr', 21053440, 'success', '2025-12-05 12:00:00', '2025-12-05 12:10:00', 'å¢é‡å¤‡ä»½æˆåŠŸ'),
    ('full', '/backup/20251206_full', 125584000, 'success', '2025-12-06 02:00:00', '2025-12-06 02:55:00', 'å…¨é‡å¤‡ä»½æˆåŠŸ'),
    ('incremental', '/backup/20251206_incr', 19922944, 'success', '2025-12-06 12:00:00', '2025-12-06 12:09:00', 'å¢é‡å¤‡ä»½æˆåŠŸ'),
    ('full', '/backup/20251207_full', 129749280, 'success', '2025-12-07 02:00:00', '2025-12-07 03:00:00', 'å…¨é‡å¤‡ä»½æˆåŠŸ'),
    ('incremental', '/backup/20251207_incr', 24117248, 'success', '2025-12-07 12:00:00', '2025-12-07 12:12:00', 'å¢é‡å¤‡ä»½æˆåŠŸ'),
    ('full', '/backup/20251208_full', 133914560, 'success', '2025-12-08 02:00:00', '2025-12-08 03:05:00', 'å…¨é‡å¤‡ä»½æˆåŠŸ'),
    ('incremental', '/backup/20251208_incr', 22020096, 'success', '2025-12-08 12:00:00', '2025-12-08 12:11:00', 'å¢é‡å¤‡ä»½æˆåŠŸ'),
    ('full', '/backup/20251209_full', 138079840, 'success', '2025-12-09 02:00:00', '2025-12-09 03:10:00', 'å…¨é‡å¤‡ä»½æˆåŠŸ'),
    ('incremental', '/backup/20251209_incr', 20971520, 'success', '2025-12-09 12:00:00', '2025-12-09 12:10:00', 'å¢é‡å¤‡ä»½æˆåŠŸ'),
    ('full', '/backup/20251210_full', 142245120, 'success', '2025-12-10 02:00:00', '2025-12-10 03:15:00', 'å…¨é‡å¤‡ä»½æˆåŠŸ'),
    ('incremental', '/backup/20251210_incr', 23068672, 'success', '2025-12-10 12:00:00', '2025-12-10 12:12:00', 'å¢é‡å¤‡ä»½æˆåŠŸ')
]

# -------------------------- æ ¸å¿ƒæ’å…¥å‡½æ•°ï¼ˆä»…ä¿®æ”¹æ•°æ®åº“è¿æ¥ç›¸å…³é€»è¾‘ï¼‰--------------------------
def connect_to_mysql():
    """è¿æ¥MySQLæ•°æ®åº“ï¼Œè¿”å›è¿æ¥å¯¹è±¡ï¼ˆpymysqlå®ç°ï¼‰"""
    try:
        # pymysql.connect() æ›¿ä»£ mysql.connector.connect()
        connection = pymysql.connect(**MYSQL_CONFIG)
        if connection.open:  # pymysqlç”¨openå±æ€§åˆ¤æ–­è¿æ¥çŠ¶æ€
            print("âœ… æˆåŠŸè¿æ¥åˆ°MySQLæ•°æ®åº“ï¼ˆsjkï¼‰")
            return connection
    except Error as e:
        print(f"âŒ æ•°æ®åº“è¿æ¥å¤±è´¥ï¼š{e}")
        return None

def batch_insert(connection, table_name, insert_sql, data_list):
    """æ‰¹é‡æ’å…¥æ•°æ®åˆ°æŒ‡å®šè¡¨ï¼ˆé€»è¾‘ä¸å˜ï¼Œé€‚é…pymysqlæ¸¸æ ‡ï¼‰"""
    try:
        cursor = connection.cursor()
        # executemanyç”¨æ³•ä¸mysql.connectorä¸€è‡´
        cursor.executemany(insert_sql, data_list)
        connection.commit()  # äº‹åŠ¡æäº¤é€»è¾‘ä¸å˜
        print(f"âœ… {table_name}è¡¨ï¼šæˆåŠŸæ’å…¥ {cursor.rowcount} æ¡æ•°æ®")
    except Error as e:
        connection.rollback()  # å¤±è´¥å›æ»šé€»è¾‘ä¸å˜
        print(f"âŒ {table_name}è¡¨ï¼šæ’å…¥å¤±è´¥ - {e}")
        raise  # æŠ›å‡ºå¼‚å¸¸ï¼Œç»ˆæ­¢åç»­æ’å…¥ï¼ˆé¿å…ä¾èµ–è¡¨å‡ºé”™ï¼‰

def insert_all_tables():
    """æŒ‰ä¾èµ–é¡ºåºæ’å…¥æ‰€æœ‰è¡¨çš„æ•°æ®ï¼ˆé€»è¾‘ä¸å˜ï¼‰"""
    connection = connect_to_mysql()
    if not connection:
        return

    try:
        # 1. æ’å…¥æ¸¸å®¢è¡¨ï¼ˆæ— ä¾èµ–ï¼Œç¬¬ä¸€ä¸ªæ‰§è¡Œï¼‰
        tourists_sql = """
        INSERT INTO tourists (tourist_id, name, id_card, phone, entry_time, exit_time, entry_method)
        VALUES (%s, %s, %s, %s, %s, %s, %s)
        """
        batch_insert(connection, "tourists", tourists_sql, TOURISTS_DATA)

        # 2. æ’å…¥é¢„çº¦è¡¨ï¼ˆä¾èµ–touristsï¼‰
        reservations_sql = """
        INSERT INTO reservations (reservation_id, tourist_id, reservation_date, entry_time_slot, group_size, status, ticket_amount, payment_status)
        VALUES (%s, %s, %s, %s, %s, %s, %s, %s)
        """
        batch_insert(connection, "reservations", reservations_sql, RESERVATIONS_DATA)

        # 3. æ’å…¥è½¨è¿¹è¡¨ï¼ˆä¾èµ–touristsï¼‰
        trajectories_sql = """
        INSERT INTO trajectories (tourist_id, location_time, latitude, longitude, area_id, off_route, warning_sent)
        VALUES (%s, %s, %s, %s, %s, %s, %s)
        """
        batch_insert(connection, "trajectories", trajectories_sql, TRAJECTORIES_DATA)

        # 4. æ’å…¥æµé‡æ§åˆ¶è¡¨ï¼ˆæ— ä¾èµ–ï¼‰
        flow_control_sql = """
        INSERT INTO flow_control (area_id, daily_capacity, current_visitors, warning_threshold, status)
        VALUES (%s, %s, %s, %s, %s)
        """
        batch_insert(connection, "flow_control", flow_control_sql, FLOW_CONTROL_DATA)

        # 5. æ’å…¥ç³»ç»Ÿæ—¥å¿—è¡¨ï¼ˆæ— ä¾èµ–ï¼‰
        system_logs_sql = """
        INSERT INTO system_logs (log_type, module, message, user_id, ip_address)
        VALUES (%s, %s, %s, %s, %s)
        """
        batch_insert(connection, "system_logs", system_logs_sql, SYSTEM_LOGS_DATA)

        # 6. æ’å…¥å¤‡ä»½è®°å½•è¡¨ï¼ˆæ— ä¾èµ–ï¼‰
        backup_logs_sql = """
        INSERT INTO backup_logs (backup_type, backup_path, file_size, status, start_time, end_time, message)
        VALUES (%s, %s, %s, %s, %s, %s, %s)
        """
        batch_insert(connection, "backup_logs", backup_logs_sql, BACKUP_LOGS_DATA)

        print("\nğŸ‰ æ‰€æœ‰è¡¨æ•°æ®æ’å…¥å®Œæˆï¼")

    except Exception as e:
        print(f"\nâŒ æ’å…¥æµç¨‹ä¸­æ–­ï¼š{e}")
    finally:
        # å…³é—­è¿æ¥ï¼ˆpymysqlåŒæ ·æ”¯æŒclose()æ–¹æ³•ï¼‰
        if connection and connection.open:
            connection.close()
            print("ğŸ”Œ æ•°æ®åº“è¿æ¥å·²å…³é—­")

# -------------------------- æ‰§è¡Œå…¥å£ï¼ˆæ— ä¿®æ”¹ï¼‰--------------------------
if __name__ == "__main__":
    insert_all_tables()